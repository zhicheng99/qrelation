webpackJsonp([1],{133:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(344),o=i(346),a=function(t){return t&&t.__esModule?t:{default:t}}(o);window.Qcanvas=n.Qcanvas,e.default={name:"App",components:{qrelation:a.default},data:function(){return{jsonData:[{node:[{id:4,nodeType:"node",x:200,y:50,text:"标题1",attr:{borderColor:"#3c3c3c",color:"#333",fillColor:"#eee",dashed:!1}},{id:5,nodeType:"node",x:400,y:200,text:"标题2",attr:{borderColor:"#7EC8CE",color:"#fff",fillColor:"#585DCB",dashed:!1}}],link:[{fromId:4,toId:5,attr:{type:"foldLine2",text:"连线关系2",like:"<--\x3e"}}]}]}},methods:{save:function(t){console.log(t)}}}},134:function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(348),a=(n(o),i(349)),s=n(a);i(358);var r=i(43),d=n(r),l=i(359),c=i(360);d.default.use(s.default);var h;e.default={name:"qrelation",components:{},props:["initWidth","initHeight","jsonData","saveFun"],data:function(){return{curr:0,sheets:[{name:"sheet1"}],nodeTitle:"",lineNodeTitle:"标题",lineType:"",lineTypeList:[{name:"直线",value:"line"},{name:"二次曲线",value:"quadraticCurve"},{name:"三次曲线",value:"bezierCurve"},{name:"折线(横向)",value:"foldLine1"},{name:"折线(竖向)",value:"foldLine2"}],lineLike:"",lineStyleList:[{name:"-",value:"-"},{name:"->",value:"->"},{name:"<-",value:"<-"},{name:"<->",value:"<->"},{name:"--",value:"--"},{name:"<--",value:"<--"},{name:"--\x3e",value:"--\x3e"},{name:"<--\x3e",value:"<--\x3e"}],containerGridColumn:1,show:!1,json:"",tipText:""}},methods:{onSubmit:function(){h.contextSettingHide()},jsShow:function(){this.json=JSON.stringify(h.returnSaveData()),this.show=!0},close:function(){this.show=!1},download:function(){h.download()},save:function(){this.saveFun&&this.saveFun(h.returnSaveData())},modiTitle:function(){h.modiTitle(this.nodeTitle)},modiLineTitle:function(){h.modiLineTitle(this.lineNodeTitle)},modiLineLike:function(){h.modiLineLike(this.lineLike)},modiLineType:function(){h.modiLineType(this.lineType)},modTip:function(t){var e=t.target;e.style.height="auto",e.scrollTop=0,e.style.height=e.scrollHeight+"px",h.updateTipText(e.value,parseInt(e.style.height))},modiContainerGridColumn:function(){if(""==this.containerGridColumn||0==this.containerGridColumn)return!1;h.modiContainerGridColumn(this.containerGridColumn)},init:function(){var t=this;h=new c.Qflow({id:"qcanvas",width:t.initWidth,height:t.initHeight,initData:t.jsonData[t.curr]}),new l.Drag({dragAimClass:"drag_ele",moveFun:function(t,e){},upFun:function(t){t.y>40&&t.x>0&&h.addEle(t)}})}},mounted:function(){this.init()},created:function(){},computed:{},watch:{},destroyed:function(){h.destroy(),h=null}}},136:function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var o=i(137),a=(n(o),i(43)),s=n(a),r=i(341),d=n(r);new s.default({render:function(t){return t(d.default)}}).$mount("#app")},341:function(t,e,i){"use strict";function n(t){i(342)}Object.defineProperty(e,"__esModule",{value:!0});var o=i(133),a=i.n(o);for(var s in o)"default"!==s&&function(t){i.d(e,t,function(){return o[t]})}(s);var r=i(362),d=i(132),l=n,c=d(a.a,r.a,!1,l,null,null);e.default=c.exports},342:function(t,e){},346:function(t,e,i){"use strict";function n(t){i(347)}Object.defineProperty(e,"__esModule",{value:!0});var o=i(134),a=i.n(o);for(var s in o)"default"!==s&&function(t){i.d(e,t,function(){return o[t]})}(s);var r=i(361),d=i(132),l=n,c=d(a.a,r.a,!1,l,"data-v-983ca400",null);e.default=c.exports},347:function(t,e){},348:function(t,e){},358:function(t,e){},359:function(t,e,i){"use strict";function n(t){this.drag=null,this.disX=0,this.disY=0,this.options={dragAimClass:t.dragAimClass?t.dragAimClass:"",dragServerClass:t.dragServerClass?t.dragServerClass:"",moveFun:t.moveFun?t.moveFun:function(){},upFun:t.upFun?t.upFun:function(){}},this.init()}n.prototype.addEvents=function(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent("on"+e,function(){i.call(t,arguments)})},n.prototype.removeEvents=function(t,e,i){t.removeEventListener?t.removeEventListener(e,i,!1):t.detachEvent?t.detachEvent("on"+e,i):element["on"+e]=null},n.prototype.init=function(){this.mouseMove()},n.prototype.createDragDom=function(t,e,i,n,o){var a=document.createElement("div");a.id="dragDom",a.style.position="absolute",a.style.zIndex=9999,a.style.border="dashed red 1px",a.style.boxSizing="border-box",a.style.transform="translate3d(0,0,0)",a.style.left=t+"px",a.style.top=e+"px",a.style.width=i+"px",a.style.height=n+"px",a.dataset.id=o,document.getElementById("qflow_lay").appendChild(a),this.drag=a;var s=this;this.addEvents(a,"mouseup",function(t){var e=t||window.event,i=document.documentElement.scrollLeft||document.body.scrollLeft,n=document.documentElement.scrollTop||document.body.scrollTop,o=e.pageX||e.clientX+i,r=e.pageY||e.clientY+n,d=s.getElementLeft(document.getElementById("qflow_lay")),l=s.getElementTop(document.getElementById("qflow_lay"));s.disX=0,s.disY=0,s.removeEvents(a,"mouseup",null),document.getElementById("dragDom")&&document.getElementById("qflow_lay").removeChild(document.getElementById("dragDom")),s.options.upFun({x:o-d,y:r-l,id:s.drag.getAttribute("data-id")}),s.drag=null})},n.prototype.getElementLeft=function(t){for(var e=t.offsetLeft,i=t.offsetParent;null!==i;)e+=i.offsetLeft,i=i.offsetParent;return e},n.prototype.getElementTop=function(t){for(var e=t.offsetTop,i=t.offsetParent;null!==i;)e+=i.offsetTop,i=i.offsetParent;return e},n.prototype.mouseMove=function(){var t=this;this.addEvents(document,"mouseleave",function(e){t.disX=0,t.disY=0,t.drag=null,document.getElementById("dragDom")&&document.getElementById("qflow_lay").removeChild(document.getElementById("dragDom"))}),this.addEvents(document,"mouseup",function(e){t.disX=0,t.disY=0,t.drag=null,document.getElementById("dragDom")&&document.getElementById("qflow_lay").removeChild(document.getElementById("dragDom"))}),this.addEvents(document,"mousedown",function(e){var i=e||window.event;if(i.target.className.toLowerCase().indexOf(t.options.dragAimClass)>-1){t.drag=i.target;var n=document.documentElement.scrollLeft||document.body.scrollLeft,o=document.documentElement.scrollTop||document.body.scrollTop,a=i.pageX||i.clientX+n,s=i.pageY||i.clientY+o;t.disX=a-i.target.offsetLeft,t.disY=s-i.target.offsetTop,t.createDragDom(i.target.offsetLeft-n,i.target.offsetTop-o,i.target.offsetWidth,i.target.offsetHeight,i.target.getAttribute("data-id"))}}),this.addEvents(document,"mousemove",function(e){if(null!==t.drag){var i=e||window.event,n=document.documentElement.scrollLeft||document.body.scrollLeft,o=document.documentElement.scrollTop||document.body.scrollTop,a=i.pageX||i.clientX+n,s=i.pageY||i.clientY+o;t.drag.style.left=a-t.disX-n+"px",t.drag.style.top=s-t.disY-o+"px",t.options.moveFun(a,s)}})},t.exports.Drag=n},360:function(t,e,i){"use strict";function n(t){this.options=t,this.toolLayer=null,this.menuLayer=null,this.qnodes=[],this.baseNodesWithCoordinates=[],this.containerPadding=10,this.containerChildMargin=10,this.containerTitleHeight=20,this.childNodeWidth=100,this.childNodeHeight=30,this.tipNodeWidth=150,this.tipContext=null,this.containerNodeWidth=120,this.containerNodeHeight=70,this.draging=!1,this.contextSettingNode=null,this.contextAimAttr="",this.modiTitleObj=null,this.colorRect={red:"#FF0000",orange:"#FFA500",yellow:"#FFFF00",green:"#008000",blue:"#0000FF",white:"#FFFFFF",black:"#000000",aqua:"#00FFFF",fuchsia:"#FF00FF",gray:"#808080",lime:"#00FF00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",silver:"#C0C0C0",teal:"#008080"},this.lineColor="#FF912D",this.childNodeFillColor="#eee",this.childNodeBorderColor="#3c3c3c",this.containerFillColor="#ddd",this.containerBorderColor="#3c3c3c",this.textColor="#333",this.line1Like={"-":"-","--":"--","->":"-","--\x3e":"--","<-":"<-","<--":"<--","<->":"<-","<--\x3e":"<--"},this.line2Like={"-":"-","--":"--","->":"-","--\x3e":"--","<-":"-","<--":"--","<->":"-","<--\x3e":"--"},this.line3Like={"-":"-","--":"--","->":"->","--\x3e":"--\x3e","<-":"-","<--":"--","<->":"->","<--\x3e":"--\x3e"},this.init()}n.prototype.init=function(){this.reSizeByInitData(),this.initChildPosition(),this.initCanvas(),this.initNode(),this.lineLayer=this.qcanvas.qlayer.layer(),this.lineCache={},this.solveLink(),this.initLink(),this.contextSettingLayer=this.qcanvas.qlayer.layer(),this.contextSettingLayer.setDisplay("none"),this.settingIco=null,this.initSettingIco(),this.contextMenuLayer=this.qcanvas.qlayer.layer(),this.contextMenuLayer.setDisplay("none"),this.contextMenuNode=null,this.initMenu(),this.tmpLine=null,this.contextLineMenuLayer=this.qcanvas.qlayer.layer(),this.contextLineMenuLayer.setDisplay("none"),this.contextLineMenuNode=null,this.createFps()},n.prototype.createFps=function(){this.qcanvas.qtext.text({text:"qrelation Version v1.0.108",color:"#dcdcdc",fontSize:"10px",textAlign:"left",start:[5,50],pointerEvent:"none"})},n.prototype.returnSaveData=function(){var t=JSON.parse(JSON.stringify(this.options.initData));return t.node&&t.node.forEach(function(t){delete t.childNodes}),t.link&&t.link.forEach(function(t){delete t.fromNode,delete t.toNode}),t},n.prototype.initContextLineMenuArea=function(t){var e=this.qcanvas.qrect.rect({start:[t.x,t.y],width:150,height:150,borderColor:"",fillColor:"yellow",drag:!1});this.contextLineMenuLayer.push(e)},n.prototype.resetPosOfLineModiTitleNode=function(){var t=this.contextLineMenuLayer.elements[0],e=t.start[0]+5,i=t.start[1]+5,n=.5*(t.width-10),o=document.getElementById("lineTitleInput");o.style.left=e+"px",o.style.top=i+"px",o.style.width=n+"px",o.style.height="30px",o.style.display="block"},n.prototype.modiLineTitle=function(t){null!==this.modiTitleObj&&this.modiTitleObj.setText(t),this.getLineJsonByNodeId(this.contextLineMenuNode.id).attr.text=t},n.prototype.modiLineLike=function(t){if(this.contextLineMenuNode.relationLineId){var e=this.lineLayer.getEleById(this.contextLineMenuNode.relationLineId[0]),i=this.lineLayer.getEleById(this.contextLineMenuNode.relationLineId[1]);e.setLike(this.line1Like[t]),i.setLike(this.line3Like[t]),this.contextLineMenuNode.setLike(this.line2Like[t])}else this.contextLineMenuNode.setLike(t);this.getLineJsonByNodeId(this.contextLineMenuNode.id).attr.like=t},n.prototype.modiLineType=function(t){var e=this.getLineJsonByNodeId(this.contextLineMenuNode.id);(void 0!==e.attr.type&&t!=e.attr.type||void 0===e.attr.type)&&(e.attr.type=t,this.lineLayer.destroy(),this.initLink(),this.lineMenuLayerHide())},n.prototype.initLineModiTitleNode=function(){var t=this.contextLineMenuLayer.elements[0],e=t.start[0]+5,i=t.start[1]+5,n=.5*(t.width-10),o=document.getElementById("lineTitleInput");o.style.left=e+"px",o.style.top=i+"px",o.style.width=n+"px",o.style.height="30px",o.style.display="block",this.modiTitleObj=this.lineLayer.getEleById(this.contextLineMenuNode.withTextId),o.value=this.modiTitleObj.text},n.prototype.initLineLikeNode=function(){var t=this.contextLineMenuLayer.elements[0],e=t.start[0]+.5*t.width,i=t.start[1]+5,n=.5*(t.width-10),o=document.getElementById("lineLike");o.style.left=e+"px",o.style.top=i+"px",o.style.width=n+"px",o.style.height="30px",o.style.display="block",o.value=this.contextLineMenuNode.like},n.prototype.initLineTypeNode=function(){var t=this.contextLineMenuLayer.elements[0],e=t.start[0]+5,i=t.start[1]+t.height-40,n=.5*(t.width-10),o=document.getElementById("lineType");o.style.left=e+"px",o.style.top=i+"px",o.style.width=n+"px",o.style.height="30px",o.style.display="block",o.value=""},n.prototype.initLineColorRect=function(){var t=this,e=this.contextLineMenuLayer.elements[0],i=[{x:e.start[0]+10,y:e.start[1]+30+10},{x:e.start[0]+e.width-10,y:e.start[1]+e.height+30-10}],n=this.childPositionByRow(4,6,i,13,13),o=[];for(var a in this.colorRect)o.push(this.colorRect[a]);for(var a=0;a<o.length;a++)this.contextLineMenuLayer.push(this.qcanvas.qrect.rect({start:[n[a].x,n[a].y],width:13,height:13,fillColor:o[a],drag:!1,mouseup:function(){t.contextLineMenuNode.setColor(this.fillColor),t.getLineJsonByNodeId(t.contextLineMenuNode.id).attr.color=this.fillColor,t.lineLayer.getEleById(t.contextLineMenuNode.withTextId).setColor(this.fillColor)}}))},n.prototype.delLineNode=function(){var t=this,e=this.options.initData.link.filter(function(e){return e.lineId!=t.contextLineMenuNode.id});if(this.options.initData.link=e,void 0!==this.contextLineMenuNode.withTextId){var i=this.lineLayer.getEleById(this.contextLineMenuNode.withTextId);this.lineLayer.removeEle(i),this.lineLayer.removeEleById(this.contextLineMenuNode.withTextId)}void 0!==this.contextLineMenuNode.relationLineId&&this.contextLineMenuNode.relationLineId.forEach(function(e){t.lineLayer.removeEleById(e)}),this.lineLayer.removeEle(this.contextLineMenuNode)},n.prototype.initLineDelBtn=function(){var t=this,e=this.contextLineMenuLayer.elements[0];this.contextLineMenuLayer.push(this.qcanvas.qrect.rect({start:[e.start[0]+e.width-70,e.start[1]+e.height-40],width:60,height:30,fillColor:"#fff",drag:!1,mouseup:function(){console.log("del"),t.delLineNode(),t.lineMenuLayerHide()}}),this.qcanvas.qtext.text({text:"删除",start:[e.start[0]+e.width-40,e.start[1]+e.height-25],fontSize:"12px",color:"#000",pointerEvent:"none"}))},n.prototype.initLineMenu=function(t){this.lineMenuLayerHide(),this.initContextLineMenuArea(t),this.initLineModiTitleNode(),this.initLineLikeNode(),this.initLineTypeNode(),this.initLineColorRect(),this.initLineDelBtn()},n.prototype.download=function(){var t=document.getElementById(this.options.id),e=document.createElement("canvas"),i=e.getContext("2d");e.width=this.options.width,e.height=this.options.height,i.fillStyle="#fff",i.fillRect(0,0,parseInt(t.style.width),parseInt(t.style.height)),i.drawImage(t,0,-40,parseInt(t.style.width),parseInt(t.style.height));var n=document.createElement("a");n.download="",n.href=e.toDataURL("image/png",1),document.body.appendChild(n),n.click(),n.remove()},n.prototype.destroy=function(){this.qcanvas.elements.forEach(function(t){"layer"==t.TYPE&&t.destroy()}),this.qcanvas.destroy()},n.prototype.lineMenuLayerShow=function(t){this.contextLineMenuLayer.setDisplay("block")},n.prototype.lineMenuLayerHide=function(){this.contextLineMenuLayer.setDisplay("none"),this.contextLineMenuLayer.destroy();var t=document.getElementById("lineTitleInput"),e=document.getElementById("lineLike"),i=document.getElementById("lineType");t.style.display="none",e.style.display="none",i.style.display="none"},n.prototype.updateTmpLineEndPos=function(t){null!==this.tmpLine&&this.tmpLine.setEnd([t.x,t.y])},n.prototype.delTmpLine=function(){if(null!==this.tmpLine){var t=this.qcanvas.getEleById(this.tmpLine.withTextId);this.qcanvas.removeEle(this.tmpLine),this.qcanvas.removeEle(t),this.tmpLine=null}},n.prototype.createNewLine=function(t,e){var i=this;if(null!==this.contextMenuNode){var n=this.getJsonObj(this.contextMenuNode.id);if(n.id==e.id)return this.contextMenuNode=null,!1;this.options.initData.link.push({fromId:n.id,toId:e.id,attr:{like:"->",color:this.lineColor,text:"连线关系"}}),this.solveLink();var o=this.options.initData.link[this.options.initData.link.length-1],a=this.qcanvas.qline.line({start:function(){return i.calcLineStartPos(o.fromNode,o.toNode,this.id)},end:function(){return i.calcLineEndPos(o.fromNode,o.toNode,this.id)},width:1,drag:!1,like:o.attr.like,color:o.attr.color,withText:"连接关系",mouseup:function(t,e){"2"==t.button&&(i.contextLineMenuNode=this,i.qcanvas.raiseToTop(i.contextLineMenuLayer),i.initLineMenu(e),i.lineMenuLayerShow(),i.contextSettingHide())}});this.lineLayer.push(a),o.lineId=a.id,this.contextMenuNode=null}},n.prototype.createTmpLine=function(t){var e=this.contextMenuNode.centerPoints();this.tmpLine=this.qcanvas.qline.line({start:[e.x,e.y],end:[t.x,t.y],width:1,like:"->",color:this.lineColor,withText:"连接关系",withTextAlign:"left",pointerEvent:"none"})},n.prototype.getLineObj=function(t){var e=this.lineLayer.elements.filter(function(e){return e.id==t});return e.length>0?e[0]:null},n.prototype.getLineJsonByNodeId=function(t){var e=this.options.initData.link.filter(function(e){return e.lineId==t});return e.length>0?e[0]:null},n.prototype.getDelLineObj=function(t){var e=this,i=[];return t.forEach(function(t){e.options.initData.link.forEach(function(n){n.fromNode.id!=t.id&&n.toNode.id!=t.id||i.push(e.getLineObj(n.lineId))})}),i},n.prototype.getDelTextObj=function(t){var e=[],i=this.qcanvas.elements.filter(function(t){return"text"==t.TYPE});return t.forEach(function(t){i.forEach(function(i){void 0!==i.ownerId&&i.ownerId==t.id&&e.push(i)})}),e},n.prototype.getWithTextObj=function(t){var e=this,i=[];return t.forEach(function(t){e.lineLayer.elements.forEach(function(e){void 0!==t.withTextId&&e.id==t.withTextId&&i.push(e)})}),i},n.prototype.updateNodeJsonAfterDelNode=function(t){var e=this;t.forEach(function(t){e.getJsonObj(t.id).isDel=!0});for(var i=[],n=0;n<this.options.initData.node.length;n++)void 0!==this.options.initData.node[n].isDel&&this.options.initData.node[n].isDel||(i.push(this.options.initData.node[n]),void 0!==i[i.length-1].child&&(i[i.length-1].child=i[i.length-1].child.filter(function(t){return void 0===t.isDel||!t.isDel})));this.options.initData.node=i},n.prototype.updatelinkJsonAfterDelNode=function(t){var e=this;t.forEach(function(t){e.options.initData.link.forEach(function(e){e.lineId==t.id&&(e.isDel=!0)})}),this.options.initData.link=this.options.initData.link.filter(function(t){return void 0===t.isDel||!t.isDel})},n.prototype.delNode=function(){var t=this,e=this.contextMenuNode.id;this.contextMenuNode=null;var i=this.getJsonObj(e),n=[];"container"==i.nodeType?(n=n.concat(i.childNodes),n.push(this.getNodeObj(i.nodeId))):n.push(this.getNodeObj(i.nodeId));var o=this.getDelLineObj(n);this.updateNodeJsonAfterDelNode(n),this.updatelinkJsonAfterDelNode(o),o.forEach(function(e){void 0!==e.withTextId&&t.lineLayer.removeEleById(e.withTextId),void 0!==e.relationLineId&&e.relationLineId.forEach(function(e){t.lineLayer.removeEleById(e)}),t.lineLayer.removeEleById(e.id)}),n.forEach(function(e){if(void 0!==e.ownerId){var i=t.getJsonObj(e.ownerId);if(null!==i){if(i.childNodes.forEach(function(t){t.id==e.id&&(t.isDel=!0)}),i.childNodes=i.childNodes.filter(function(t){return void 0===t.isDel||!t.isDel}),i.childNodes.forEach(function(t,e){t.sort=e}),"top-center"==i.attr.titlePosition){var n=t.containerTitleHeight+t.containerPadding,o=Math.ceil((0==i.child.length?1:i.child.length)/i.grid[1]);i.height=n+t.childNodeHeight*o+o*t.containerChildMargin,i.grid[0]=o;t.getNodeObj(e.ownerId).setHeight(i.height)}var a=t.getChildAreaPosition(i),s=t.getChildPosition(i,a);i.attr.gridPosition=s}}void 0!==e.ownerId&&t.lineLayer.removeEleById(e.ownerId),void 0!==e.withTextId&&t.qcanvas.removeEleById(e.withTextId),t.qcanvas.removeEle(e)}),t.contextMenuNode=null},n.prototype.cloneNode=function(){var t=this,e=this.contextMenuNode,i=this.getJsonObj(e.id);if("node"==i.nodeType&&(void 0===e.ownerId?this.addNode({x:i.x+20,y:i.y+20},i.text):this.inSertToContainer({},{id:e.ownerId},i.text)),"container"==i.nodeType){var n=this.addContainer({x:i.x+20,y:i.y+20},{text:i.text,grid:i.grid,width:i.width,height:i.height});i.child.forEach(function(e){t.inSertToContainer({},{id:n},e.text)})}"tip"==i.nodeType&&(console.log("clone tip"),this.cloneTipNode()),this.contextMenuNode=null},n.prototype.initMenu=function(){var t=this,e=this.qcanvas.qrect.rect({start:[0,0],width:100,height:75,borderColor:"",fillColor:"#fff",drag:!1}),i=this.qcanvas.qrect.rect({start:function(){return e.start},width:100,height:25,borderColor:"",fillColor:"#fff",drag:!1,mouseup:function(e,i){t.menuLayerHide(),t.createTmpLine(i)}}),n=this.qcanvas.qtext.text({text:"连接到",start:function(){return[t.contextMenuLayer.elements[0].start[0]+.5*t.contextMenuLayer.elements[0].width,t.contextMenuLayer.elements[0].start[1]+12.5]},fontSize:"12px",color:"#000",pointerEvent:"none"}),o=this.qcanvas.qrect.rect({start:function(){return[e.start[0],e.start[1]+25]},width:100,height:25,borderColor:"",fillColor:"#fff",drag:!1,mouseup:function(e,i){console.log("clone"),t.menuLayerHide(),t.cloneNode()}}),a=this.qcanvas.qtext.text({text:"克隆",start:function(){return[t.contextMenuLayer.elements[0].start[0]+.5*t.contextMenuLayer.elements[0].width,t.contextMenuLayer.elements[0].start[1]+25+12.5]},fontSize:"12px",color:"#000",pointerEvent:"none"}),s=this.qcanvas.qrect.rect({start:function(){return[e.start[0],e.start[1]+50]},width:100,height:25,borderColor:"",fillColor:"#fff",drag:!1,mouseup:function(e,i){console.log("删除"),t.menuLayerHide(),t.delNode()}}),r=this.qcanvas.qtext.text({text:"删除",start:function(){return[t.contextMenuLayer.elements[0].start[0]+.5*t.contextMenuLayer.elements[0].width,t.contextMenuLayer.elements[0].start[1]+50+12.5]},fontSize:"12px",color:"#000",pointerEvent:"none"});this.contextMenuLayer.push(e,i,n,o,a,s,r)},n.prototype.menuLayerShow=function(t){this.contextMenuLayer.elements[0].setStart([t.x,t.y]),this.contextMenuLayer.setDisplay("block"),this.qcanvas.raiseToTop(this.contextMenuLayer)},n.prototype.menuLayerHide=function(){this.contextMenuLayer.setDisplay("none")},n.prototype.initSettingIco=function(){var t=this;this.settingIco=this.qcanvas.qarc.arc({start:[0,0],sAngle:0,eAngle:360,borderColor:"red",fillColor:"red",opacity:.5,r:5,display:"none",drag:!1,mousemove:function(){this.setDisplay("block")},mouseup:function(e,i){t.contextSettingHide(),t.delTmpLine(),t.contextMenuNode=null,t.contextSettingNode=this.contextSettingNode,t.qcanvas.raiseToTop(t.contextSettingLayer),t.contextSettingShow(i),t.lineMenuLayerHide()}})},n.prototype.settingIcoShow=function(t){var e=this.qcanvas.isFun(t.start)?t.start():t.start,i=e[0]+t.width-8,n=e[1]+8;this.settingIco.contextSettingNode=t,this.settingIco.setStart([i,n]),this.settingIco.setDisplay("block"),this.qcanvas.raiseToTop(this.settingIco)},n.prototype.settingIcoHide=function(){this.settingIco.setDisplay("none")},n.prototype.initContextCover=function(){var t=this;this.contextSettingLayer.push(this.qcanvas.qrect.rect({start:[0,0],width:this.qcanvas.stage.width,height:this.qcanvas.stage.height,borderColor:"",fillColor:"#000",opacity:.1,drag:!1,mouseup:function(){t.contextSettingHide()}}))},n.prototype.contextSettingShow=function(t){this.initContextMenuArea(t),this.initModiTitleNode(),this.initContextMenuTab(),this.initColorRect(),this.contextSettingLayer.setDisplay("block")},n.prototype.initDelBtn=function(){var t=this,e=this.contextSettingLayer.elements[1];this.contextSettingLayer.push(this.qcanvas.qrect.rect({start:[e.start[0]+e.width-70,e.start[1]+e.height-40],width:60,height:30,fillColor:"#fff",drag:!1,mouseup:function(){t.delNode(),t.contextSettingHide()}}),this.qcanvas.qtext.text({text:"删除",start:[e.start[0]+e.width-40,e.start[1]+e.height-25],fontSize:"12px",color:"#000",pointerEvent:"none"}))},n.prototype.modiTitle=function(t){this.modiTitleObj&&this.modiTitleObj.setText(t),this.getJsonObj(this.contextSettingNode.nodeId).text=t;var e=this.getNodeObj(this.contextSettingNode.nodeId),i=(this.modiTitleObj.polyPoints(),this.modiTitleObj.formatText.call(this,this.modiTitleObj)),n=Math.max.apply(null,i.width);n=n>e.width?n:e.width;var o=this.qcanvas.isFun(e.start)?e.start():e.start,a=n>e.width?o[0]-.5*(n-e.width):o[0],s=document.getElementById("titleInput");s.style.width=n+"px",s.style.left=a+"px"},n.prototype.initModiTitleNode=function(){var t=this.getJsonObj(this.contextSettingNode.id),e=this.contextSettingLayer.elements[0],i=e.start[0]+10,n=e.start[1]+10,o=e.width-20;if("container"==t.nodeType){this.contextSettingLayer.push(this.qcanvas.qtext.text({start:[i+10,n+120],text:"列:",color:"#000"}));var a=document.getElementById("containerGridColumn");a.style.left=i+30+"px",a.style.top=n+105+"px",a.style.width=o-30+"px",a.style.height="30px",a.style.display="block",a.value=t.grid[1]}},n.prototype.contextSettingHide=function(){this.contextSettingNode=null,this.contextSettingLayer.setDisplay("none");var t=document.getElementById("titleInput"),e=document.getElementById("containerGridColumn");t.style.display="none",e.style.display="none",this.contextSettingLayer.destroy()},n.prototype.initColorRect=function(){var t=this,e=this.contextSettingLayer.elements[0],i=[{x:e.start[0]+10,y:e.start[1]+30},{x:e.start[0]+e.width-10,y:e.start[1]+e.height-10}],n=this.childPositionByRow(4,6,i,20,20),o=[];for(var a in this.colorRect)o.push(this.colorRect[a]);for(var a=0;a<o.length;a++)this.contextSettingLayer.push(this.qcanvas.qrect.rect({start:[n[a].x,n[a].y],width:20,height:20,fillColor:o[a],drag:!1,mouseup:function(){"color"==t.contextAimAttr?t.updateNodeTitleColor(this.fillColor):t.contextSettingNode[t.contextAimAttr]=this.fillColor,t.updateInitDataAttr(this.fillColor)}}))},n.prototype.updateNodeTitleColor=function(t){var e=this,i=function(){var t=e.options.initData.node.filter(function(t){return t.nodeId==e.contextSettingNode.id});if(t.length>0)return t[0];console.log("没有找到");var t;return e.options.initData.node.forEach(function(i){if("container"==i.nodeType)for(var n=0;n<i.child.length;n++)if(i.child[n].nodeId==e.contextSettingNode.id){t=i.child[n];break}}),t}(),n=this.qnodes.filter(function(t){return t.id==i.attr.titleId});n.length>0&&(n[0][e.contextAimAttr]=t)},n.prototype.updateInitDataAttr=function(t){var e=this;(function(){var t=e.options.initData.node.filter(function(t){return t.nodeId==e.contextSettingNode.id});if(t.length>0)return t[0];console.log("没有找到");var t;return e.options.initData.node.forEach(function(i){if("container"==i.nodeType)for(var n=0;n<i.child.length;n++)if(i.child[n].nodeId==e.contextSettingNode.id){t=i.child[n];break}}),t})().attr[e.contextAimAttr]=t},n.prototype.initContextMenuTab=function(){var t=this,e=this.contextSettingLayer.elements[0],i=[{text:"边框颜色",aimAttr:"borderColor"},{text:"背景颜色",aimAttr:"fillColor"},{text:"文字颜色",aimAttr:"color"}];i.forEach(function(n,o){var a=e.start[0]+o*(200/i.length)+200/i.length*.5;0==o&&(t.contextAimAttr=n.aimAttr);var s=t.qcanvas.qtext.text({text:n.text,start:[a,e.start[1]+15],color:0==o?"#000":"#ccc",aimAttr:n.aimAttr,drag:!1,mouseup:function(){var e=this;t.contextSettingLayer.elements.forEach(function(i){"text"==i.TYPE&&(i.color="#ccc",i.id==e.id&&(t.contextAimAttr=i.aimAttr,i.color="#000"))})}});t.contextSettingLayer.push(s)})},n.prototype.initContextMenuArea=function(t){this.contextSettingLayer.push(this.qcanvas.qrect.rect({start:[t.x,t.y],width:200,height:200,borderColor:"",fillColor:"yellow",drag:!1}))},n.prototype.getContainerNodes=function(){var t=[];return null!==this.options.initData.node&&this.options.initData.node.length>0&&(t=this.options.initData.node.filter(function(t){return"container"==t.nodeType})),t},n.prototype.getChildAreaPosition=function(t){var e=t.attr.titlePosition,i=0;return"top-center"==e&&(i+=this.containerTitleHeight+this.containerPadding),[{x:t.x+0+this.containerChildMargin,y:t.y+i},{x:t.x+t.width-0,y:t.y+t.height-0}]},n.prototype.childPositionByRow=function(t,e,i,n,o){for(var a=[],s=0;s<t;s++)for(var r=0;r<e;r++)a[s]?a[s].push({x:i[0].x+r*n+r*this.containerChildMargin,y:i[0].y+s*o+s*this.containerChildMargin}):a[s]=[{x:i[0].x+r*n+r*this.containerChildMargin,y:i[0].y+s*o+s*this.containerChildMargin}];var d=[];return a.forEach(function(t){d=d.concat(t)}),d},n.prototype.getChildPosition=function(t,e){var i=t.grid,n=(t.child,t.child.length,i[0]),o=i[1];e[1].x,e[0].x,e[1].y,e[0].y;return this.childPositionByRow(n,o,e,this.childNodeWidth,this.childNodeHeight)},n.prototype.initChildPosition=function(){if(null!==this.options.initData)for(var t=this.getContainerNodes(),e=0;e<t.length;e++){var i=this.getChildAreaPosition(t[e]),n=this.getChildPosition(t[e],i);t[e].attr.gridPosition=n}},n.prototype.reSizeByInitData=function(){if(null!==this.options.initData&&null!==this.options.initData.node&&this.options.initData.node.length>0){var t=this,e=[],i=[];this.options.initData.node.map(function(n){"container"==n.nodeType?(e.push(n.x+n.width),i.push(n.y+n.height)):(e.push(n.x+t.childNodeWidth),i.push(n.y+t.childNodeHeight))});var n=Math.max.apply(null,e),o=Math.max.apply(null,i);this.options.width=n>=this.options.width?n:this.options.width,this.options.height=o>=this.options.height?o:this.options.height}},n.prototype.getNodeIdFromJsonById=function(t){for(var e=null,i=0;i<this.options.initData.node.length;i++){if(this.options.initData.node[i].id==t){e=this.options.initData.node[i].nodeId;break}if(this.options.initData.node[i].child)for(var n=0;n<this.options.initData.node[i].child.length;n++)if(this.options.initData.node[i].child[n].id==t){e=this.options.initData.node[i].child[n].nodeId;break}}return e},n.prototype.calcLineStartPos=function(t,e,i){var n=this,o=function(){var i=t.centerPoints(),n=e.centerPoints(),o=t.getRangePoints(),a=e.getRangePoints();return i.y>=n.y?o[0][1]<=a[6][1]?o[0][0]>=a[2][0]?o[7]:o[2][0]<=a[0][0]?o[3]:o[1]:o[0][0]>=a[2][0]?o[1]:(o[2][0],a[2][0],o[1]):a[0][1]<=o[6][1]?o[0][0]>=a[2][0]?o[7]:o[2][0]<=a[0][0]?o[3]:o[5]:o[0][0]>=a[2][0]?o[5]:(o[2][0],a[0][0],o[5])};return void 0!==this.lineCache['"'+i+'"']&&void 0!==this.lineCache['"'+i+'"'].oldStart?(new Date).getTime()-n.lineCache['"'+i+'"'].startCallTime>300&&(n.lineCache['"'+i+'"'].startCallTime=(new Date).getTime(),n.lineCache['"'+i+'"'].oldStart=o()):(void 0===n.lineCache['"'+i+'"']&&(n.lineCache['"'+i+'"']={}),n.lineCache['"'+i+'"'].startCallTime=(new Date).getTime(),n.lineCache['"'+i+'"'].oldStart=o()),n.lineCache['"'+i+'"'].oldStart},n.prototype.calcLineEndPos=function(t,e,i){var n=this,o=function(){var i=t.centerPoints(),n=e.centerPoints(),o=t.getRangePoints(),a=e.getRangePoints();return i.y>=n.y?o[0][1]<=a[6][1]?o[0][0]>=a[2][0]?a[3]:o[2][0]<=a[0][0]?a[7]:a[1]:o[0][0]>=a[2][0]?a[5]:(o[2][0],a[2][0],a[5]):a[0][1]<=o[6][1]?o[0][0]>=a[2][0]?a[3]:o[2][0]<=a[0][0]?a[7]:a[5]:o[0][0]>=a[2][0]?a[1]:(o[2][0],a[0][0],a[1])};return void 0!==this.lineCache['"'+i+'"']&&void 0!==this.lineCache['"'+i+'"'].oldEnd?(new Date).getTime()-n.lineCache['"'+i+'"'].endCallTime>300&&(n.lineCache['"'+i+'"'].endCallTime=(new Date).getTime(),n.lineCache['"'+i+'"'].oldEnd=o()):(void 0===n.lineCache['"'+i+'"']&&(n.lineCache['"'+i+'"']={}),n.lineCache['"'+i+'"'].endCallTime=(new Date).getTime(),n.lineCache['"'+i+'"'].oldEnd=o()),n.lineCache['"'+i+'"'].oldEnd},n.prototype.calcLinePos=function(t,e,i){var n=function(){var i=t.centerPoints(),n=e.centerPoints(),o=t.getRangePoints(),a=e.getRangePoints(),s=[0,0],r=[0,0];return i.y>=n.y?o[0][1]<=a[6][1]?o[0][0]>=a[2][0]?(s=o[7],r=a[3]):o[2][0]<=a[0][0]?(s=o[3],r=a[7]):(s=o[1],r=a[1]):o[0][0]>=a[2][0]?(s=o[1],r=a[5]):(o[2][0],a[2][0],s=o[1],r=a[5]):a[0][1]<=o[6][1]?o[0][0]>=a[2][0]?(s=o[7],r=a[3]):o[2][0]<=a[0][0]?(s=o[3],r=a[7]):(s=o[5],r=a[5]):o[0][0]>=a[2][0]?(s=o[5],r=a[1]):(o[2][0],a[0][0],s=o[5],r=a[1]),{start:s,end:r}};return void 0!==this.lineCache['"'+i+'"']?(new Date).getTime()-this.lineCache['"'+i+'"'].callTime>300&&(this.lineCache['"'+i+'"'].callTime=(new Date).getTime(),this.lineCache['"'+i+'"'].position=n()):this.lineCache['"'+i+'"']={callTime:(new Date).getTime(),position:n()},this.lineCache['"'+i+'"'].position},n.prototype.solveLink=function(){var t=this;this.options.initData.link.forEach(function(e){e.fromNode=t.getNodeObj(t.getNodeIdFromJsonById(e.fromId)),e.toNode=t.getNodeObj(t.getNodeIdFromJsonById(e.toId)),void 0===e.attr.color&&(e.attr.color=t.lineColor)})},n.prototype.caleHandler1=function(){if(void 0===this.caleTime1||void 0!==this.caleTime1&&(new Date).getTime()-this.caleTime1>1e3){var t=this.start(),e=this.end(),i=function(){return t[0]<e[0]&&t[1]<=e[1]?[.25*Math.abs(t[0]-e[0])+t[0],.75*Math.abs(t[1]-e[1])+t[1]]:t[0]>=e[0]&&t[1]<=e[1]?[.75*Math.abs(t[0]-e[0])+e[0],.75*Math.abs(t[1]-e[1])+t[1]]:t[0]>e[0]&&t[1]>=e[1]?[.25*Math.abs(t[0]-e[0])+e[0],.75*Math.abs(t[1]-e[1])+e[1]]:t[0]<=e[0]&&t[1]>=e[1]?[.75*Math.abs(t[0]-e[0])+t[0],.75*Math.abs(t[1]-e[1])+e[1]]:void 0}();return this.oldHandler1=i,this.caleTime1=(new Date).getTime(),this.oldHandler1}return this.oldHandler1},n.prototype.caleHandler2=function(){if(void 0===this.caleTime2||void 0!==this.caleTime2&&(new Date).getTime()-this.caleTime2>1e3){var t=this.start(),e=this.end(),i=function(){return t[0]<e[0]&&t[1]<=e[1]?[.75*Math.abs(t[0]-e[0])+t[0],.25*Math.abs(t[1]-e[1])+t[1]]:t[0]>=e[0]&&t[1]<=e[1]?[.25*Math.abs(t[0]-e[0])+e[0],.25*Math.abs(t[1]-e[1])+t[1]]:t[0]>e[0]&&t[1]>e[1]?[.75*Math.abs(t[0]-e[0])+e[0],.25*Math.abs(t[1]-e[1])+e[1]]:t[0]<=e[0]&&t[1]>e[1]?[.25*Math.abs(t[0]-e[0])+t[0],.25*Math.abs(t[1]-e[1])+e[1]]:void 0}();return this.oldHandler2=i,this.caleTime2=(new Date).getTime(),this.oldHandler2}return this.oldHandler2},n.prototype.caleQuadraticCurveHandler=function(){if(void 0===this.caleTime1||void 0!==this.caleTime1&&(new Date).getTime()-this.caleTime1>1e3){var t=this.start(),e=this.end(),i=function(){return t[0]<e[0]&&t[1]<=e[1]?[.25*Math.abs(t[0]-e[0])+t[0],.75*Math.abs(t[1]-e[1])+t[1]]:t[0]>=e[0]&&t[1]<=e[1]?[.75*Math.abs(t[0]-e[0])+e[0],.75*Math.abs(t[1]-e[1])+t[1]]:t[0]>e[0]&&t[1]>=e[1]?[.75*Math.abs(t[0]-e[0])+e[0],.25*Math.abs(t[1]-e[1])+e[1]]:t[0]<=e[0]&&t[1]>=e[1]?[.25*Math.abs(t[0]-e[0])+t[0],.25*Math.abs(t[1]-e[1])+e[1]]:void 0}();return this.oldQuadraticCurveHandler=i,this.caleTime1=(new Date).getTime(),this.oldQuadraticCurveHandler}return this.oldQuadraticCurveHandler},n.prototype.initLink=function(){var t=this;this.options.initData.link.forEach(function(e){if(void 0!==e.attr.type)switch(e.attr.type){case"bezierCurve":var i=t.qcanvas.qbezierCurve.bezierCurve({start:function(){return t.calcLinePos(e.fromNode,e.toNode,this.id).start},end:function(){return t.calcLinePos(e.fromNode,e.toNode,this.id).end},handler1:t.caleHandler1,handler2:t.caleHandler2,width:1,drag:!1,like:e.attr.like,color:e.attr.color?e.attr.color:this.lineColor,withText:e.attr.text,mouseup:function(e,i){"2"==e.button&&(t.contextLineMenuNode=this,t.qcanvas.raiseToTop(t.contextLineMenuLayer),t.initLineMenu(i),t.lineMenuLayerShow(),t.contextSettingHide())}});break;case"quadraticCurve":var i=t.qcanvas.qquadraticCurve.quadraticCurve({start:function(){return t.calcLinePos(e.fromNode,e.toNode,this.id).start},end:function(){return t.calcLinePos(e.fromNode,e.toNode,this.id).end},handler:t.caleQuadraticCurveHandler,width:1,drag:!1,like:e.attr.like,color:e.attr.color?e.attr.color:this.lineColor,withText:e.attr.text,mouseup:function(e,i){"2"==e.button&&(t.contextLineMenuNode=this,t.qcanvas.raiseToTop(t.contextLineMenuLayer),t.initLineMenu(i),t.lineMenuLayerShow(),t.contextSettingHide())}});break;case"line":var i=t.qcanvas.qline.line({start:function(){return t.calcLinePos(e.fromNode,e.toNode,this.id).start},end:function(){return t.calcLinePos(e.fromNode,e.toNode,this.id).end},width:1,drag:!1,like:e.attr.like,color:e.attr.color?e.attr.color:this.lineColor,withText:e.attr.text,mouseup:function(e,i){"2"==e.button&&(t.contextLineMenuNode=this,t.qcanvas.raiseToTop(t.contextLineMenuLayer),t.initLineMenu(i),t.lineMenuLayerShow(),t.contextSettingHide())}});break;case"foldLine1":case"foldLine2":var i=t.createFoldLine(e.fromNode,e.toNode,e.attr)}else var i=t.qcanvas.qline.line({start:function(){return t.calcLinePos(e.fromNode,e.toNode,this.id).start},end:function(){return t.calcLinePos(e.fromNode,e.toNode,this.id).end},width:1,drag:!1,like:e.attr.like,color:e.attr.color?e.attr.color:this.lineColor,withText:e.attr.text,mouseup:function(e,i){"2"==e.button&&(t.contextLineMenuNode=this,t.qcanvas.raiseToTop(t.contextLineMenuLayer),t.initLineMenu(i),t.lineMenuLayerShow(),t.contextSettingHide())}});t.qcanvas.isArr(i)?(e.lineId=i[1].id,t.lineLayer.push(i[0],i[1],i[2])):(e.lineId=i.id,t.lineLayer.push(i))})},n.prototype.caleFoldLinePosition=function(t,e,i,n){var o=this.calcLinePos(t,e,n),a=o.start,s=o.end,r=i.disPercent?i.disPercent:.5;return"foldLine1"==i.type?{l1:function(){return[a,[a[0],(s[1]-a[1])*r+a[1]]]},l2:function(){return[[a[0],(s[1]-a[1])*r+a[1]],[s[0],(s[1]-a[1])*r+a[1]]]},l3:function(){return[[s[0],(s[1]-a[1])*r+a[1]],s]}}:"foldLine2"==i.type?{l1:function(){return[a,[(s[0]-a[0])*r+a[0],a[1]]]},l2:function(){return[[(s[0]-a[0])*r+a[0],a[1]],[(s[0]-a[0])*r+a[0],s[1]]]},l3:function(){return[[(s[0]-a[0])*r+a[0],s[1]],s]}}:void 0},n.prototype.createFoldLine=function(t,e,i){var n=this,o=n.qcanvas.qline.line({start:function(){return n.caleFoldLinePosition(t,e,i,this.id).l1()[0]},end:function(){return n.caleFoldLinePosition(t,e,i,this.id).l1()[1]},pointerEvent:"none",width:1,like:n.line1Like[i.like],color:i.color?i.color:n.lineColor}),a=n.qcanvas.qline.line({start:function(){return n.caleFoldLinePosition(t,e,i,this.id).l3()[0]},end:function(){return n.caleFoldLinePosition(t,e,i,this.id).l3()[1]},pointerEvent:"none",width:1,like:n.line3Like[i.like],color:i.color?i.color:n.lineColor});return[o,n.qcanvas.qline.line({start:function(){return n.caleFoldLinePosition(t,e,i,this.id).l2()[0]},end:function(){return n.caleFoldLinePosition(t,e,i,this.id).l2()[1]},drag:!1,width:1,like:n.line2Like[i.like],color:i.color?i.color:n.lineColor,withText:i.text,relationLineId:[o.id,a.id],mouseup:function(t,e){"2"==t.button&&(n.contextLineMenuNode=this,n.qcanvas.raiseToTop(n.contextLineMenuLayer),n.initLineMenu(e),n.lineMenuLayerShow(),n.contextSettingHide())}}),a]},n.prototype.updateInitData=function(t,e){if(e.x=t.start[0],e.y=t.start[1],"container"==e.nodeType){var i=this.getChildAreaPosition(e),n=this.getChildPosition(e,i);e.attr.gridPosition=n}},n.prototype.initNodeTitle=function(t,e){var i=this,n=this.qcanvas.qtext.text({start:function(){var t=i.qcanvas.isFun(e.start)?e.start():e.start;return[t[0]+.5*e.width,t[1]+.5*e.height]},text:t.text,pointerEvent:"none",color:t.attr&&t.attr.color?t.attr.color:i.textColor,fontSize:"12px",ownerId:t.nodeId});this.qnodes.push(n),t.attr.titleId=n.id},n.prototype.initContainerTitle=function(t,e){var i=this,n=this.qcanvas.qtext.text({start:function(){return[e.start[0]+.5*e.width,e.start[1]+.5*i.containerTitleHeight]},text:t.text,pointerEvent:"none",color:t.attr?t.attr.color:"#000",fontSize:"12px",ownerId:t.nodeId});this.qnodes.push(n),t.attr.titleId=n.id},n.prototype.drawNode=function(t,e){for(var i=this,n=0;n<e.length;n++)null!==t?i.createChildsOfContainer(t,e[n],n):"tip"==e[n].nodeType?i.createTipNode(e[n]):i.createContainerOrNode(e[n])},n.prototype.createChildsOfContainer=function(t,e,i){var n=this,o=this.qcanvas.qrect.rect({start:function(){return[t.attr.gridPosition[this.sort].x,t.attr.gridPosition[this.sort].y]},sort:i,nodeType:e.nodeType,width:e.width?e.width:this.childNodeWidth,height:e.height?e.height:this.childNodeHeight,borderColor:e.attr&&e.attr.borderColor?e.attr.borderColor:this.childNodeBorderColor,fillColor:e.attr&&e.attr.fillColor?e.attr.fillColor:this.childNodeFillColor,dashed:!(!e.attr||!e.attr.dashed)&&e.attr.dashed,drag:!1,ownerId:t.nodeId,lineWidth:1,getRangePoints:function(){return n.createRangePoints(this.polyPoints())},mouseenter:function(){n.settingIcoShow(this)},mousedown:function(){n.delTmpLine(),n.createNewLine(this,e),n.tipTextHide(),n.menuLayerHide(),n.draging=!0},mouseup:function(t,e){n.settingIcoHide(),n.menuLayerHide(),n.draging=!1,"2"==t.button&&(n.contextMenuNode=this,n.menuLayerShow(e))},mousemove:function(t,i){n.updateTmpLineEndPos(i),n.settingIcoShow(this),n.draging&&n.updateInitData.call(n,this,e)},mouseout:function(){n.settingIcoHide()},dblclick:function(t,i){console.log("dbl"),n.settingIcoHide(),n.menuLayerHide(),n.containerDblclick.call(n,this,t,i,e)}});void 0===e.id&&(e.id=o.id),e.nodeId=o.id,t.childNodes?t.childNodes.push(o):t.childNodes=[o],this.qnodes.push(o),this.initNodeTitle(e,o)},n.prototype.getNodeObj=function(t){var e=this.qnodes.filter(function(e){return e.id==t});return e.length>0?e[0]:null},n.prototype.getJsonObj=function(t){for(var e=null,i=0;i<this.options.initData.node.length;i++){if(this.options.initData.node[i].nodeId==t){e=this.options.initData.node[i];break}if(this.options.initData.node[i].child)for(var n=0;n<this.options.initData.node[i].child.length;n++)if(this.options.initData.node[i].child[n].nodeId==t){e=this.options.initData.node[i].child[n];break}}return e},n.prototype.containerMouseDown=function(t,e){var i=this;this.qcanvas.raiseToTop(t),this.qcanvas.raiseToTop(this.lineLayer);var n=i.getNodeObj(e.attr.titleId);null!==n&&i.qcanvas.raiseToTop(n),"container"==e.nodeType&&(e.childNodes&&e.childNodes.forEach(function(t){i.qcanvas.raiseToTop(t),t.setPointerEvent("none")}),e.child&&e.child.forEach(function(t){var e=i.getNodeObj(t.attr.titleId);null!==e&&(i.qcanvas.raiseToTop(e),e.setPointerEvent("none"))}),this.qcanvas.raiseToTop(this.lineLayer)),i.draging=!0},n.prototype.containerMouseUp=function(t,e,i,n){var o=this;o.draging=!1,"container"==n.nodeType&&n.childNodes&&n.childNodes.forEach(function(t){t.setPointerEvent("auto")}),this.isResizeCanvas(n.nodeId),"2"==e.button&&(o.contextMenuNode=t,o.menuLayerShow(i))},n.prototype.containerDblclick=function(t,e,i,n){if(console.log(n),console.log(t),"node"==n.nodeType){this.contextSettingNode=n;var o=this.getNodeObj(n.attr.titleId);console.log(o),this.modiTitleObj=o;var a=o.formatText.call(this,o),s=Math.max.apply(null,a.width);s=s>t.width?s:t.width;var r=this.qcanvas.isFun(t.start)?t.start():t.start,d=s>t.width?r[0]-.5*(s-t.width):r[0],l=this.childNodeHeight,c=r[1],h=document.getElementById("titleInput");h.style.left=d+"px",h.style.top=c+"px",h.style.width=s+"px",h.style.height=l+"px",h.style.display="block",h.style.textAlign="center",h.value=o.text,h.focus()}if("container"==n.nodeType){var r=this.qcanvas.isFun(t.start)?t.start():t.start;if("in"==this.rayCasting(i,[{x:r[0],y:r[1]},{x:r[0]+t.width,y:r[1]},{x:r[0]+t.width,y:r[1]+16},{x:r[0],y:r[1]+16}])){console.log("开始编辑容器标题"),this.contextSettingNode=n;var o=this.getNodeObj(n.attr.titleId);console.log(o),this.modiTitleObj=o;var a=o.formatText.call(this,o),s=Math.max.apply(null,a.width);s=s>t.width?s:t.width;var r=this.qcanvas.isFun(t.start)?t.start():t.start,d=s>t.width?r[0]-.5*(s-t.width):r[0],l=this.childNodeHeight,c=r[1],h=document.getElementById("titleInput");h.style.left=d+"px",h.style.top=c+"px",h.style.width=s+"px",h.style.height=l+"px",h.style.display="block",h.style.textAlign="center",h.value=o.text,h.focus()}}},n.prototype.resizeCanvas=function(t,e){var i=window.devicePixelRatio,n=this.qcanvas.stage.canvas;n.width=t*i,n.height=e*i,n.style.width=t+"px",n.style.height=e+"px",n.getContext("2d").scale(i,i),this.qcanvas.elements.forEach(function(n){if("layer"==n.TYPE){var o=n.canvasEle;o.width=t*i,o.height=e*i,o.getContext("2d").scale(i,i)}}),this.options.width=t,this.options.height=e,this.qcanvas.stage.width=t,this.qcanvas.stage.height=e},n.prototype.isResizeCanvas=function(t){var e=this,i=function(){var i=e.getNodeObj(t);if(null!==i){var n=e.qcanvas.isFun(i.start)?i.start():i.start,o=n[0]+i.width,a=n[1]+i.height;(o>e.options.width||a>e.options.height)&&(console.log("需要重置canvas尺寸"),e.resizeCanvas(o>e.options.width?o:e.options.width,a>e.options.height?a:e.options.height))}};setTimeout(i,200)},n.prototype.containerMouseMove=function(t,e){this.draging&&this.updateInitData(t,e)},n.prototype.getMiddleCoordinate=function(t,e){var i=[t.x,t.y],n=[e.x,e.y];return[(i[0]<n[0]?i[0]:n[0])+.5*Math.abs(i[0]-n[0]),(i[1]<n[1]?i[1]:n[1])+.5*Math.abs(i[1]-n[1])]},n.prototype.createRangePoints=function(t){for(var e=[],i=0;i<t.length;i++)e.push([t[i].x,t[i].y]),e.push(this.getMiddleCoordinate(t[i],t[i+1==t.length?0:i+1]));return e},n.prototype.tipTextHide=function(){if(null!==this.tipContext){this.tipContext.setColor("#B58105");var t=this.getJsonObj(this.tipContext.ownerId);t.text=this.tipContext.text,t.width=this.tipNodeWidth,t.height=this.tipContext.range.height,this.tipContext=null}document.getElementById("tip").style.display="none"},n.prototype.updateTipText=function(t,e){if(null!==this.tipContext){t=this.formatTipText(t),this.tipContext.setText(t);this.getNodeObj(this.tipContext.ownerId).setHeight(e)}},n.prototype.measureTextWidth=function(t){return this.qcanvas.context.measureText(t).width},n.prototype.formatTipText=function(t){for(var e=0,i=0,n=[],o=0;o<t.length;o++)e+=this.measureTextWidth(t[o]),"\n"==t[o]&&(e=0),e>this.tipNodeWidth&&(n.push(t.substring(i,o)),e=this.measureTextWidth(t[o]),i=o),o==t.length-1&&n.push(t.substring(i,o+1));return n.join("\n")},n.prototype.cloneTipNode=function(){console.log(this.contextMenuNode);var t=this.getJsonObj(this.contextMenuNode.id),e={nodeType:"tip",x:this.contextMenuNode.start[0]+20,y:this.contextMenuNode.start[1]+20,width:this.tipNodeWidth,height:this.contextMenuNode.height,text:t.text,attr:{borderColor:"#7EC8CE",color:"#fff",fillColor:"#585DCB",dashed:!1}};this.createTipNode(e),this.options.initData.node.push(e)},n.prototype.addTipNode=function(t){var e={nodeType:"tip",x:t.x,y:t.y,width:this.tipNodeWidth,text:"备注",attr:{borderColor:"#7EC8CE",color:"#fff",fillColor:"#585DCB",dashed:!1}};this.createTipNode(e),this.options.initData.node.push(e)},n.prototype.createTipNode=function(t){var e=this,i=this.qcanvas.qrect.rect({start:[t.x,t.y],nodeType:t.nodeType,width:t.width?t.width:this.tipNodeWidth,height:t.height?t.height:this.childNodeHeight,borderColor:"orange",fillColor:"#FEF8DE",dashed:t.attr.dashed,getRangePoints:function(){return e.createRangePoints(this.polyPoints())},dblclick:function(i,n){var o=this.start[0],a=this.start[1],s=document.getElementById("tip");s.style.top=a+"px",s.style.left=o+"px",s.style.width=this.width+"px",s.style.height=this.height+"px",s.style.fontSize="12px",s.style.lineHeight="14px",s.style.display="block",e.tipContext=e.getNodeObj(t.attr.titleId),e.tipContext.setColor("#FEF8DE"),s.value=e.tipContext.text,s.focus()},mousedown:function(){e.delTmpLine(),e.createNewLine(this,t),e.menuLayerHide(),e.containerMouseDown.call(e,this,t)},mouseup:function(i,n){e.settingIcoHide(),e.menuLayerHide(),e.containerMouseUp.call(e,this,i,n,t)},mousemove:function(i,n){if(e.updateTmpLineEndPos(n),e.containerMouseMove.call(e,this,t),null===e.qcanvas.dragAim)return!1}});void 0===t.id&&(t.id=i.id),t.nodeId=i.id,this.qnodes.push(i),this.baseNodesWithCoordinates.push(i),this.initTipText(t,i)},n.prototype.initTipText=function(t,e){var i=this.qcanvas.qtext.text({start:function(){return[e.start[0],e.start[1]+3]},text:t.text,fontSize:"12px",lineHeight:"14px",color:"#B58105",textAlign:"left",textBaseline:"top",pointerEvent:"none",ownerId:t.nodeId});e.withTextId=i.id,this.qnodes.push(i),t.attr.titleId=i.id},n.prototype.createContainerOrNode=function(t){var e=this,i=this.qcanvas.qrect.rect({start:[t.x,t.y],nodeType:t.nodeType,width:t.width?t.width:this.childNodeWidth,height:t.height?t.height:this.childNodeHeight,borderColor:t.attr.borderColor,fillColor:t.attr.fillColor,dashed:t.attr.dashed,getRangePoints:function(){return e.createRangePoints(this.polyPoints())},mouseenter:function(){e.settingIcoShow(this)},mousedown:function(){e.delTmpLine(),e.createNewLine(this,t),e.tipTextHide(),e.menuLayerHide(),e.containerMouseDown.call(e,this,t),e.contextMenuNode=null,e.contextSettingHide()},mouseup:function(i,n){e.settingIcoHide(),e.menuLayerHide(),e.containerMouseUp.call(e,this,i,n,t)},mousemove:function(i,n){e.updateTmpLineEndPos(n),e.settingIcoShow(this),e.containerMouseMove.call(e,this,t)},mouseout:function(){e.settingIcoHide()},dblclick:function(i,n){e.settingIcoHide(),e.menuLayerHide(),e.containerDblclick.call(e,this,i,n,t)}});t.nodeId=i.id,this.qnodes.push(i),this.baseNodesWithCoordinates.push(i),"container"==t.nodeType&&this.initContainerTitle(t,i),"node"==t.nodeType&&this.initNodeTitle(t,i),"container"==t.nodeType&&void 0!==t.child&&this.initNode(t)},n.prototype.initNode=function(t){t?this.drawNode(t,t.child):this.drawNode(null,this.options.initData.node)},n.prototype.initCanvas=function(){this.qcanvas=new Qcanvas({id:this.options.id,width:this.options.width,height:this.options.height,mousedown:this.canvasDownFun.bind(this),mousemove:this.canvasMoveFun.bind(this),mouseup:this.canvasUpFun.bind(this),delayRender:!0})},n.prototype.addContainer=function(t,e){var i=this,n=this.qcanvas.qrect.rect({start:[t.x,t.y],width:e&&e.width?e.width:this.containerNodeWidth,height:e&&e.height?e.height:this.containerNodeHeight,borderColor:this.containerBorderColor,fillColor:this.containerFillColor,dashed:!1,getRangePoints:function(){return i.createRangePoints(this.polyPoints())},mouseenter:function(){i.settingIcoShow(this)},mousedown:function(){i.delTmpLine(),i.createNewLine(this,o),i.menuLayerHide(),i.containerMouseDown.call(i,this,o),i.contextMenuNode=null,i.contextSettingHide()},mouseup:function(t,e){i.settingIcoHide(),i.menuLayerHide(),i.containerMouseUp.call(i,this,t,e,o)},mousemove:function(t,e){i.updateTmpLineEndPos(e),i.settingIcoShow(this),i.containerMouseMove.call(i,this,o)},mouseout:function(){i.settingIcoHide()},dblclick:function(t,e){i.settingIcoHide(),i.menuLayerHide(),i.containerDblclick.call(i,this,t,e,o)}});this.qnodes.push(n),this.baseNodesWithCoordinates.push(n);var o={id:n.id,nodeId:n.id,nodeType:"container",x:t.x,y:t.y,text:e&&e.text?e.text:"容器标题",width:e&&e.width?e.width:this.containerNodeWidth,height:e&&e.height?e.height:this.containerNodeHeight,grid:e&&e.grid?e.grid:[1,1],child:[],childNodes:[],attr:{titlePosition:"top-center",color:this.textColor,borderColor:this.containerBorderColor,fillColor:this.containerFillColor,dashed:!1}};return this.options.initData.node.push(o),this.updateInitData(n,o),this.initContainerTitle(o,n),n.id},n.prototype.modiContainerGridColumn=function(t){var e=this.getNodeObj(this.contextSettingNode.id),i=this.getJsonObj(this.contextSettingNode.id);if(i.width=this.childNodeWidth*t+(t+1)*this.containerChildMargin,"top-center"==i.attr.titlePosition){var n=this.containerTitleHeight+this.containerPadding,o=Math.ceil((0==i.child.length?1:i.child.length)/t);i.height=n+this.childNodeHeight*o+o*this.containerChildMargin,i.grid=[o,t]}e.setWidth(i.width),e.setHeight(i.height);var a=this.getChildAreaPosition(i),s=this.getChildPosition(i,a);i.attr.gridPosition=s},n.prototype.inSertToContainer=function(t,e,i){console.log("创建的节点需要初始到容器里");var n=this.getJsonObj(e.id),o=this.getNodeObj(e.id);if(n.attr.gridPosition.length<=n.child.length){n.height+=this.childNodeHeight+this.containerChildMargin,n.grid[0]+=1,o.setHeight(n.height);var a=this.getChildAreaPosition(n),s=this.getChildPosition(n,a);n.attr.gridPosition=s}var r={nodeType:"node",text:i||"我是新来的",attr:{color:this.textColor}};this.createChildsOfContainer(n,r,n.child.length),n.child.push(r)},n.prototype.addNode=function(t,e){var i=this,n=this.qcanvas.qrect.rect({start:[t.x,t.y],width:this.childNodeWidth,height:this.childNodeHeight,borderColor:this.childNodeBorderColor,fillColor:this.childNodeFillColor,dashed:!1,getRangePoints:function(){return i.createRangePoints(this.polyPoints())},mouseenter:function(){i.settingIcoShow(this)},mousedown:function(){i.delTmpLine(),i.createNewLine(this,o),i.menuLayerHide(),i.containerMouseDown.call(i,this,o)},mouseup:function(t,e){i.settingIcoHide(),i.menuLayerHide(),i.containerMouseUp.call(i,this,t,e,o)},mousemove:function(t,e){i.updateTmpLineEndPos(e),i.settingIcoShow(this),i.containerMouseMove.call(i,this,o)},mouseout:function(){i.settingIcoHide()},dblclick:function(t,e){console.log("dbl"),i.settingIcoHide(),i.menuLayerHide(),i.containerDblclick.call(i,this,t,e,o)}});this.qnodes.push(n),this.baseNodesWithCoordinates.push(n);var o={id:n.id,nodeId:n.id,nodeType:"node",x:t.x,y:t.y,text:e||"标题",attr:{borderColor:this.childNodeBorderColor,color:this.textColor,fillColor:this.childNodeFillColor,dashed:!1}};this.options.initData.node.push(o),this.initNodeTitle(o,n)},n.prototype.rayCasting=function(t,e){for(var i=t.x,n=t.y,o=!1,a=0,s=e.length,r=s-1;a<s;r=a,a++){var d=e[a].x,l=e[a].y,c=e[r].x,h=e[r].y;if(d===i&&l===n||c===i&&h===n)return"on";if(l<n&&h>=n||l>=n&&h<n){var u=d+(n-l)*(c-d)/(h-l);if(u===i)return"on";u>i&&(o=!o)}}return o?"in":"out"},n.prototype.inContainer=function(t){for(var e=this.qcanvas.elements,i=null,n=e.length-1;n>=0;n--)if("none"!=e[n].display&&"layer"!=e[n].TYPE&&"in"==this.rayCasting({x:t.x,y:t.y},e[n].polyPoints())){console.log("找到了"),i=e[n];break}var o=!1;if(null!==i)if(void 0!==i.ownerId){var a=this.getJsonObj(i.ownerId);i=this.getNodeObj(i.ownerId),"container"==a.nodeType&&(o=!0)}else{var s=this.getJsonObj(i.id);null!==s&&"container"==s.nodeType&&(o=!0)}return{sign:o,aim:i}},n.prototype.addEle=function(t){switch(t.id){case"-1":var e=this.addContainer(t);this.inSertToContainer({},{id:e},"标题");break;case"1":var i=this.inContainer(t);i.sign?this.inSertToContainer(t,i.aim):this.addNode(t);break;case"2":this.addTipNode(t)}},n.prototype.canvasUpFun=function(){console.log("canvasUpFun")},n.prototype.canvasMoveFun=function(t,e){var i=this;if(this.updateTmpLineEndPos(e),null!==this.qcanvas.dragAim&&this.qcanvas.dragAim.id==this.qcanvas.id){if(0==this.qnodes.length)return!1;this.baseNodesWithCoordinates.forEach(function(t){t.start=[e.x-t.dis.x,e.y-t.dis.y],null!==i.getJsonObj(t.id)&&i.updateInitData(t,i.getJsonObj(t.id))})}},n.prototype.canvasDownFun=function(t,e){this.delTmpLine(),this.contextMenuNode=null,this.menuLayerHide(),this.lineMenuLayerHide(),this.contextSettingHide(),this.tipTextHide(),this.baseNodesWithCoordinates.forEach(function(t){t.dis={x:e.x-t.start[0],y:e.y-t.start[1]}})},n.prototype.rectDown=function(t){},n.prototype.initTool=function(){var t=this.options[2],e=this.qcanvas.qrect.rect({start:[0,0],width:200,lineWidth:.5,height:t,drag:!1}),i=this.qcanvas.qrect.rect({start:function(){return[e.start[0]+20,e.start[1]+20]},width:70,height:50,drag:!1,mousedown:this.rectDown}),n=this.qcanvas.qshape.shape({fillColor:"",points:function(){return[[e.start[0]+i.width+30,e.start[1]+45],[e.start[0]+i.width+70,e.start[1]+20],[e.start[0]+i.width+110,e.start[1]+45],[e.start[0]+i.width+70,e.start[1]+70]]},drag:!1}),o=this.qcanvas.qarc.arc({start:[300,100],sAngle:0,eAngle:200,fillColor:"",r:10});this.toolLayer.push(e,i,n,o)},t.exports.Qflow=n},361:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"qflow_lay"}},[i("div",{staticClass:"tool"},[t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),i("span",{staticClass:"save",on:{click:t.save}},[i("img",{attrs:{src:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjAyMjk4MDA1NzAyIiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjQ0MTQiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48L3N0eWxlPjwvZGVmcz48cGF0aCBkPSJNODk1LjgzIDYyLjEwMmMzMS43NjEgNS4yOTQgNTIuOTM1IDI2LjQ2OCA2MC44NzYgNTIuOTM1IDcuOTQgMTguNTI3IDUuMjk0IDgyLjA0OSA1LjI5NCAxMDguNTE3djYxNi42OTVjMCAxOC41MjcgMCA0Mi4zNDktMi42NDcgNTUuNTgyLTIuNjQ3IDMxLjc2MS0yMy44MjEgNTIuOTM1LTUwLjI4OCA2MC44NzYtMTguNTI3IDcuOTQtODQuNjk3IDUuMjk0LTEwOC41MTcgNS4yOTQtMjA2LjQ0NyAwLTQxMi44OTUgMC02MTkuMzQyIDAtMTUuODgxIDAtMzkuNzAxIDAtNTUuNTgyLTIuNjQ3LTI5LjExNS0yLjY0Ny01Mi45MzUtMjMuODIxLTYwLjg3Ni01MC4yODgtNS4yOTQtMTguNTI3LTIuNjQ3LTg0LjY5Ny0yLjY0Ny0xMDguNTE3di02MTkuMzQyYzAtMTUuODgxIDAtMzcuMDU1IDAtNTIuOTM1IDUuMjk0LTMxLjc2MSAyNi40NjctNTIuOTM1IDUyLjkzNS02My41MjIgMTguNTI3LTUuMjk0IDgyLjA0OS0yLjY0NyAxMDguNTE3LTIuNjQ3IDIwNi40NDcgMCA0MTAuMjQ4IDAgNjE2LjY5NSAwIDE1Ljg4MSAwIDM5LjcwMSAwIDU1LjU4MiAwek0zMzQuNzE5IDM2MS4xODZoMzU0LjY2NmMxMC41ODcgMCAxMy4yMzQtNS4yOTQgMTMuMjM0LTEzLjIzNHYtMjMwLjI2OGgtMzgxLjEzM3YyMjIuMzI4YzAgMTUuODgxLTIuNjQ3IDIxLjE3MyAxMy4yMzQgMjEuMTczek03NTguMiAxMTcuNjg0djI0OC43OTZjMCAzNy4wNTUtNy45NCA1MC4yODgtNDQuOTk0IDUwLjI4OC05Ny45MyAwLTM3MC41NDYgMC00MTguMTg4IDAtMjEuMTczIDAtMjkuMTE1LTEwLjU4Ny0yOS4xMTUtMzcuMDU1di0yNjIuMDI5Yy0zMS43NjEgMC04NC42OTcgMC0xMTYuNDU4IDAtMTUuODgxIDAtMjYuNDY3IDAtMjkuMTE1IDEwLjU4Ny0yLjY0NyA3Ljk0LTIuNjQ3IDEzNy42MzItMi42NDcgMTU2LjE1OHY1OTIuODc0YzAgMTMuMjM0IDAgMjMuODIxIDEzLjIzNCAyNi40NjcgNS4yOTQgMi42NDcgMTM3LjYzMiAyLjY0NyAxNTYuMTU4IDIuNjQ3IDUyLjkzNSAwIDU4LjIyOCAwIDExMS4xNjQgMHYtMTc5Ljk3OWgyMjcuNjIxdjE3OS45NzljNzQuMTA5IDAgMTExLjE2NCAwIDE4Ny45MiAwIDEwLjU4NyAwIDc0LjEwOSAwIDc5LjQwMy0yLjY0NyAxMC41ODctMi42NDcgMTMuMjM0LTEwLjU4NyAxMy4yMzQtMjYuNDY3di02NjkuNjNjMC0xMy4yMzQgMC02OC44MTUtMi42NDctNzYuNzU2LTIuNjQ3LTEzLjIzNC0xOC41MjctMTMuMjM0LTI2LjQ2Ny0xMy4yMzQtMzQuNDA4IDAtODQuNjk3IDIuNjQ3LTExOS4xMDQgMHpNNDUzLjgyMyA5MDMuNzcybDExNi40NTggMi42NDd2LTEyNC4zOThoLTExNi40NTh2MTIxLjc1MXoiIHAtaWQ9IjQ0MTUiPjwvcGF0aD48L3N2Zz4=",height:"20",alt:"",draggable:"false"}})]),t._v(" "),i("span",{staticClass:"download",on:{click:t.download}},[i("img",{attrs:{src:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjAyMzk1NTUzNjQwIiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjI0MDkiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48L3N0eWxlPjwvZGVmcz48cGF0aCBkPSJNODMyLjEgNTkyLjdjLTExIDAtMjAgOS0yMCAyMHYxNTEuMmMwIDExLTkgMjAtMjAgMjBIMjMxLjljLTExIDAtMjAtOS0yMC0yMFY2MTIuN2MwLTExLTktMjAtMjAtMjBzLTIwIDktMjAgMjB2MTUxLjJjMCAzMy4xIDI2LjkgNjAgNjAgNjBINzkyYzMzLjEgMCA2MC0yNi45IDYwLTYwVjYxMi43YzAuMS0xMS04LjktMjAtMTkuOS0yMHoiIHAtaWQ9IjI0MTAiPjwvcGF0aD48cGF0aCBkPSJNNDY4LjMgNjU4LjZjMTEuMyAxMS45IDI3LjIgMTguNyA0My42IDE4LjcgMTYuNCAwIDMyLjMtNi44IDQzLjYtMTguOGw5OS4xLTEwNC43YzcuNi04IDcuMi0yMC43LTAuOC0yOC4zLTgtNy42LTIwLjctNy4yLTI4LjMgMC44bC05My42IDk4LjlWMjIwYzAtMTEtOS0yMC0yMC0yMHMtMjAgOS0yMCAyMHY0MDUuMmwtOTMuNC05OC42Yy03LjYtOC0yMC4zLTguNC0yOC4zLTAuOC04IDcuNi04LjQgMjAuMy0wLjggMjguM2w5OC45IDEwNC41eiIgcC1pZD0iMjQxMSI+PC9wYXRoPjwvc3ZnPg==",height:"20",alt:"",draggable:"false"}})]),t._v(" "),i("span",{staticClass:"json",on:{click:t.jsShow}},[i("img",{attrs:{src:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjAzMzgyNzgzMzY1IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjI3MjgiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48L3N0eWxlPjwvZGVmcz48cGF0aCBkPSJNMjE2LjQgMTA3LjFoNTAuMmM1LjcgMCAxMC40IDQuNyAxMC40IDEwLjRWMTU2YzAgNS43LTQuNyAxMC40LTEwLjQgMTAuNGgtNDUuOGMtNS43IDAtMTMuNCA0LjYtMTMuNCAxMC40bC0xIDI0Ni42Yy0xLjMgMzUuMi0yNS4xIDkwLTU4LjYgOTEuNCAyMy4yLTEgNTkuNiAzOS41IDU5LjYgODkuNGwtMSAyNDIuNGMwIDUuOCA0LjcgMTkuNiAxMC42IDE5LjZoNDkuM2M1LjkgMCAxMC44IDYuOCAxMC44IDEyLjh2MzAuOWMwIDUuOS00LjggMTAuOC0xMC44IDEwLjhoLTQ5LjhjLTMyLjQtMTIuMi02MC42LTQwLjctNjAuNi05MC40di0xODFjMC00OS45LTI3LjEtOTAuNC02MC42LTkwLjRINzcuMWMtNi44IDAtMTIuMi01LjUtMTIuMi0xMi4ydi02NS45YzAtNi44IDUuNS0xMi4yIDEyLjItMTIuMmgxOC4xYzMzLjUgMCA2MC42LTQwLjUgNjAuNi05MC40VjE5Ny40YzAtNDkuOSAyNy4xLTkwLjMgNjAuNi05MC4zTTgwOC42IDEwNy4xYzMzLjUgMCA2MC42IDQwLjQgNjAuNiA5MC4zdjE4MC44YzAgNDkuOSAyNy4xIDkwLjQgNjAuNiA5MC40aDE4LjFjNi43IDAgMTIuMiA1LjQgMTIuMiAxMi4ydjY1LjljMCA2LjctNS40IDEyLjItMTIuMiAxMi4yaC0xOC4yYy0zMy41IDAtNjAuNiA0MC41LTYwLjYgOTAuNHYxODFjMCA0OS43LTI4LjIgNzguMi02MC42IDkwLjRoLTQ5LjhjLTYgMC0xMC44LTQuOS0xMC44LTEwLjhWODc5YzAtNiA0LjktMTIuOCAxMC44LTEyLjhIODA4YzUuOSAwIDEwLjYtMTMuOCAxMC42LTE5LjZsLTEtMjQyLjRjMC00OS45IDM2LjQtOTAuNCA1OS42LTg5LjQtMzMuNS0xLjQtNTcuMy01Ni4yLTU4LjYtOTEuNGwtMS0yNDYuNmMwLTUuOC03LjctMTAuNC0xMy40LTEwLjRoLTQ1LjhjLTUuNyAwLTEwLjQtNC43LTEwLjQtMTAuNHYtMzguNWMwLTUuNyA0LjctMTAuNCAxMC40LTEwLjRoNTAuMk01MDguNCA2NjcuOGMxNi44IDAgMzAuNCAxMy42IDMwLjQgMzAuNCAwIDE2LjgtMTMuNiAzMC40LTMwLjQgMzAuNC0xNi44IDAtMzAuNC0xMy42LTMwLjQtMzAuNCAwLTE2LjggMTMuNi0zMC40IDMwLjQtMzAuNE0zODYuOCA2NjcuOGMxNi44IDAgMzAuNCAxMy42IDMwLjQgMzAuNCAwIDE2LjgtMTMuNiAzMC40LTMwLjQgMzAuNC0xNi44IDAtMzAuNC0xMy42LTMwLjQtMzAuNCAwLTE2LjggMTMuNi0zMC40IDMwLjQtMzAuNE02MzAgNjY3LjhjMTYuOCAwIDMwLjQgMTMuNiAzMC40IDMwLjQgMCAxNi44LTEzLjYgMzAuNC0zMC40IDMwLjQtMTYuOCAwLTMwLjQtMTMuNi0zMC40LTMwLjQgMC0xNi44IDEzLjYtMzAuNCAzMC40LTMwLjR6IiBwLWlkPSIyNzI5Ij48L3BhdGg+PC9zdmc+",height:"20",alt:"",draggable:"false"}})])]),t._v(" "),i("div",{style:{height:t.initHeight+"px"},attrs:{id:"qcanvas_lay"}},[i("canvas",{attrs:{id:"qcanvas"}}),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.nodeTitle,expression:"nodeTitle"}],attrs:{type:"text",id:"titleInput",autocomplete:"off"},domProps:{value:t.nodeTitle},on:{input:[function(e){e.target.composing||(t.nodeTitle=e.target.value)},t.modiTitle],keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSubmit(e)}}}),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model.number",value:t.containerGridColumn,expression:"containerGridColumn",modifiers:{number:!0}}],attrs:{type:"text",id:"containerGridColumn",autocomplete:"off"},domProps:{value:t.containerGridColumn},on:{input:[function(e){e.target.composing||(t.containerGridColumn=t._n(e.target.value))},t.modiContainerGridColumn],blur:function(e){return t.$forceUpdate()}}}),t._v(" "),i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.tipText,expression:"tipText"}],attrs:{name:"",id:"tip"},domProps:{value:t.tipText},on:{input:[function(e){e.target.composing||(t.tipText=e.target.value)},function(e){return t.modTip(e)}]}}),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.lineNodeTitle,expression:"lineNodeTitle"}],attrs:{type:"text",id:"lineTitleInput",autocomplete:"off"},domProps:{value:t.lineNodeTitle},on:{input:[function(e){e.target.composing||(t.lineNodeTitle=e.target.value)},t.modiLineTitle]}}),t._v(" "),i("select",{directives:[{name:"model",rawName:"v-model",value:t.lineLike,expression:"lineLike"}],attrs:{id:"lineLike",autocomplete:"off"},on:{change:[function(e){var i=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.lineLike=e.target.multiple?i:i[0]},t.modiLineLike]}},t._l(t.lineStyleList,function(e){return i("option",{domProps:{value:e.value}},[t._v(t._s(e.name))])}),0),t._v(" "),i("select",{directives:[{name:"model",rawName:"v-model",value:t.lineType,expression:"lineType"}],attrs:{id:"lineType",autocomplete:"off"},on:{change:[function(e){var i=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.lineType=e.target.multiple?i:i[0]},t.modiLineType]}},t._l(t.lineTypeList,function(e){return i("option",{domProps:{value:e.value}},[t._v(t._s(e.name))])}),0)]),t._v(" "),i("el-dialog",{attrs:{title:"json数据",visible:t.show,width:"30%"},on:{"update:visible":function(e){t.show=e},close:t.close}},[i("div",{staticClass:"json_lay"},[t._v("\n\t    \t"+t._s(t.json)+"\n\t    ")])])],1)},o=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"drag_ele",attrs:{"data-id":"-1"}},[i("img",{attrs:{src:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjAyMjk3NTk0ODc5IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjIxNDciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48L3N0eWxlPjwvZGVmcz48cGF0aCBkPSJNMjU2IDI4OGg2NHY2NGgtNjR6IG0xMjggMzg0aDM4NHY2NEgzODR6TTI1NiA0ODBoNjR2NjRoLTY0eiBtMCAxOTJoNjR2NjRoLTY0eiIgZmlsbD0iIzMzMzMzMyIgcC1pZD0iMjE0OCI+PC9wYXRoPjxwYXRoIGQ9Ik04MzIgNjRIMTkyYy0zNS4yIDAtNjQgMjguOC02NCA2NHY3NjhjMCAzNS4yIDI4LjggNjQgNjQgNjRoNjQwYzM1LjIgMCA2NC0yOC44IDY0LTY0VjEyOGMwLTM1LjItMjguOC02NC02NC02NHogbTAgODAwYzAgMTkuMi0xNiAzMi0zMiAzMkgyMjRjLTE2IDAtMzItMTIuOC0zMi0zMlYxNjBjMC0xOS4yIDE2LTMyIDMyLTMyaDU3NmMxNiAwIDMyIDEyLjggMzIgMzJ2NzA0eiIgZmlsbD0iIzMzMzMzMyIgcC1pZD0iMjE0OSI+PC9wYXRoPjxwYXRoIGQ9Ik0zODQgNDgwaDM4NHY2NEgzODR6IG0wLTE5MmgzODR2NjRIMzg0eiIgZmlsbD0iIzMzMzMzMyIgcC1pZD0iMjE1MCI+PC9wYXRoPjwvc3ZnPg==",height:"20",alt:"",draggable:"false"}})])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"drag_ele",attrs:{"data-id":"1"}},[i("img",{attrs:{src:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjAyMjk3ODY3NDcwIiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjM1MjYiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48L3N0eWxlPjwvZGVmcz48cGF0aCBkPSJNNDU4LjIgMzcxSDExMi42Qzg2LjkgMzcxIDY2IDM1MC4xIDY2IDMyNC41VjE2NC45YzAtMjUuNyAyMC45LTQ2LjUgNDYuNS00Ni41aDM0NS42YzI1LjcgMCA0Ni41IDIwLjkgNDYuNSA0Ni41djE1OS41YzAuMSAyNS43LTIwLjggNDYuNi00Ni40IDQ2LjZ6TTExMi42IDE1OC4zYy0zLjYgMC02LjYgMy02LjYgNi42djE1OS41YzAgMy42IDMgNi42IDYuNiA2LjZoMzQ1LjZjMy42IDAgNi42LTMgNi42LTYuNlYxNjQuOWMwLTMuNi0zLTYuNi02LjYtNi42SDExMi42ek05MTAuMSA5MDhIMjU4LjhjLTI1LjcgMC00Ni41LTIwLjktNDYuNS00Ni41VjUxNS45YzAtMjUuNyAyMC45LTQ2LjUgNDYuNS00Ni41aDY1MS4zYzI1LjcgMCA0Ni41IDIwLjkgNDYuNSA0Ni41djM0NS42YzAgMjUuNy0yMC44IDQ2LjUtNDYuNSA0Ni41ek0yNTguOCA1MDkuMmMtMy42IDAtNi42IDMtNi42IDYuNnYzNDUuNmMwIDMuNiAzIDYuNiA2LjYgNi42aDY1MS4zYzMuNiAwIDYuNi0zIDYuNi02LjZWNTE1LjljMC0zLjYtMy02LjYtNi42LTYuNkgyNTguOHoiIGZpbGw9IiM0RjRGNEYiIHAtaWQ9IjM1MjciPjwvcGF0aD48cGF0aCBkPSJNMjI1LjUgNjk1LjNoLTU5LjNjLTE4LjMgMC0zMy4yLTE0LjktMzMuMi0zMy4xbC0wLjUtMzA1LjhjMC0xMSA4LjktMjAgMTkuOS0yMCAxMSAwIDE5LjkgOC45IDE5LjkgMTkuOWwwLjUgMjk5LjFoNTIuN2MxMSAwIDE5LjkgOC45IDE5LjkgMTkuOXMtOC44IDIwLTE5LjkgMjB6IiBmaWxsPSIjNEY0RjRGIiBwLWlkPSIzNTI4Ij48L3BhdGg+PC9zdmc+",height:"20",alt:"",draggable:"false"}})])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"drag_ele",attrs:{"data-id":"2"}},[i("img",{attrs:{src:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjAzMDgxOTIxMDg0IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjMxMjEiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48L3N0eWxlPjwvZGVmcz48cGF0aCBkPSJNNjQuNzEzODg0IDY1MC40MDQyMWw4OTIuNjg0MjMyIDAgMCA1NS4wNTM4NzMtODkyLjY4NDIzMiAwIDAtNTUuMDUzODczWiIgcC1pZD0iMzEyMiI+PC9wYXRoPjxwYXRoIGQ9Ik01MTEuMDU3NTM1IDIzNy40ODc4NzlsNDQ2LjM0MDU4MSAwIDAgNTUuMDU2OTQzLTQ0Ni4zNDA1ODEgMCAwLTU1LjA1Njk0M1oiIHAtaWQ9IjMxMjMiPjwvcGF0aD48cGF0aCBkPSJNMTg5LjIyNTY4OSA0ODQuMzY3NjYzbDE4OC45NTM0OSAwIDQ2LjI4ODIzMyAxMTQuNzQ4NDQxIDY0Ljc0MTUxMyAwTDMxNi4zNjk0MzggMTc5LjkwNDM5M2wtNjIuNjk0OTAxIDBMODAuODMzMDAzIDU5OS4xMTYxMDNsNjQuNzQzNTYgMEwxODkuMjI1Njg5IDQ4NC4zNjc2NjN6TTI3NS42NDkwMTQgMjYyLjcxOTU0YzIuNzMxMjA0LTYuODU2MTUyIDUuMTcyODEzLTE2LjU5NzAwMyA3LjMxOTcwOS0yOS4yMjk3MThsMS40Njc0MjEgMGMyLjUzNTc1MyAxMy44OTU0NzUgNC44ODAxNDcgMjMuNjM2MzI3IDcuMDMwMTE0IDI5LjIyOTcxOGw2OC41NDkyMzYgMTc0LjI4ODQ4OEwyMDcuNjgyMDQgNDM3LjAwODAyOSAyNzUuNjQ5MDE0IDI2Mi43MTk1NHoiIHAtaWQ9IjMxMjQiPjwvcGF0aD48cGF0aCBkPSJNNTExLjA1NzUzNSAzNzUuMTI4NzAzbDQ0Ni4zNDA1ODEgMCAwIDU1LjA1Mzg3My00NDYuMzQwNTgxIDAgMC01NS4wNTM4NzNaIiBwLWlkPSIzMTI1Ij48L3BhdGg+PHBhdGggZD0iTTY0LjcxMzg4NCA3ODguMDQwOTRsODkyLjY4NDIzMiAwIDAgNTUuMDU0ODk3LTg5Mi42ODQyMzIgMCAwLTU1LjA1NDg5N1oiIHAtaWQ9IjMxMjYiPjwvcGF0aD48cGF0aCBkPSJNNTExLjA1NzUzNSA1MTIuNzY2NDU2bDQ0Ni4zNDA1ODEgMCAwIDU1LjA1NDg5Ny00NDYuMzQwNTgxIDAgMC01NS4wNTQ4OTdaIiBwLWlkPSIzMTI3Ij48L3BhdGg+PC9zdmc+",height:"20",alt:"",draggable:"false"}})])}],a={render:n,staticRenderFns:o};e.a=a},362:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[null!==t.jsonData?i("qrelation",{attrs:{"init-width":"1000","init-height":"1000","json-data":t.jsonData,"save-fun":t.save}}):t._e()],1)},o=[],a={render:n,staticRenderFns:o};e.a=a}},[136]);